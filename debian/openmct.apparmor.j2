# vim:syntax=apparmor
# AppArmor policy for openmct
# ###AUTHOR###
# ###COPYRIGHT###
# ###COMMENT###

#include <tunables/global>

# No template variables specified

"/opt/{{ openmct_org }}/openmct/service.mjs" {
  #include <abstractions/base>
  #include <abstractions/nis>

  /usr/bin/node ix,

  /etc/ssl/openssl.cnf r,
  /opt/{{ openmct_org }}/openmct/** r,
  /etc/openmct/.env r,
  /proc/** r,
  /sys/devices/system/cpu/** r,
  /sys/fs/cgroup/system.slice/openmct.service/** r,
  /usr/bin/ldd r,
  /run/systemd/resolve/stub-resolv.conf r,
  /etc/nsswitch.conf r,
  /etc/host.conf r,
  /etc/hosts r,

  capability net_bind_service,

  network inet stream,
  network inet6 stream,
  network inet dgram,
  network inet6 dgram,
  network netlink raw,

}
